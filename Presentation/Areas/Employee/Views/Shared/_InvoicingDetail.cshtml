@model DataAccess.ViewModels.InvoicingDetail
@using DataAccess.Design_Pattern.Repositories
@using DataAccess.Design_Pattern.UnitOfWork
@using System;
@using Microsoft.AspNetCore.Identity;

@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor;


@inject IUnitOfWork _context
@{

    var MainTariff = _context.tariffRepository.GetMainTariffForCreateInvoicing();
    SelectList MainTariffs = new SelectList(MainTariff, "Value", "Text");

    var SubTariff = _context.tariffRepository.GetSubTariffForCreateInvoicing(int.Parse(MainTariff.First().Value));
    SelectList SubTariffs = new SelectList(SubTariff, "Value", "Text");

}

@if (Context.Request.Query["Id"].ToString() != "empty")
{
    int ReservationOrderID = int.Parse(Context.Request.Query["Id"].ToString());

    <form asp-action="AddInvoicingDetailsToSession" asp-controller="Invoicing" asp-area="Employee" method="post" enctype="multipart/form-data">
        <input type="hidden" asp-for="ReservationOrderID" value="@ReservationOrderID"/>
        <div class="col-md-12">
            <div class="card card-warning">
                <div class="card-header">
                    <h3 class="card-title">   ریز  فاکتور   </h3>
                </div>


                <div class="form-horizontal ">
                    <div class="row">
                        <div class="card-body row">
                            <div class="col-md-5">
                                <div class="form-group">
                                    <label>عنوان  </label>
                                    <select class="form-control select2 select2-hidden-accessible" style="width: 100%;" tabindex="-1" aria-hidden="true" id="Main" asp-items="@MainTariffs">
                                        <option selected="selected">------   عنوان   -------</option>

                                    </select>
                                </div>

                            </div>

                            <div class="col-md-5">
                                <div class="form-group">
                                    <label> خدمت </label>
                                    <select class="form-control select2 select2-hidden-accessible" style="width: 100%;" tabindex="-1" aria-hidden="true" asp-for="TariffID" id="Sub" asp-items="@SubTariffs">
                                        <option selected="selected">------   انتخاب کنید   -------</option>

                                    </select>
                                </div>

                            </div>

                            <div class="col-md-2">
                                <div class="form-group">
                                    <div class="form-group">
                                        <label for="exampleInputEmail1">    مبلغ دریافتی         </label>
                                        <input type="text" class="form-control" asp-for="Price" placeholder="مبلغ را به ریال وارد کنید ">
                                    </div>
                                </div>

                            </div>

                            <div class="card-body col-md-12" style="margin-bottom:0px; margin-top:0px;">

                                <div class="form-group col-md-12">
                                    <label for="exampleInputEmail1">  توضیحات   </label>
                                    <textarea type="text" class="form-control" asp-for="Description" id="exampleInputEmail1"></textarea>
                                </div>

                            </div>

                        </div>

                    </div>
                    <div class="card-footer">
                        <button type="submit" class="btn btn-warning">ثبت </button>
                    </div>
                </div>
            </div>
        </div>


    </form>

}

